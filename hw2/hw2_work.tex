\documentclass[11pt]{article}

\usepackage{fullpage,graphicx,latexsym,picinpar,amsbsy,amsmath,amsfonts}

\input{macros.tex}

\begin{document}
	
% v -- YOUR NAME and SID in the braces
\student{Nathan Ha}{862377326}  
% v -- YOUR NAME and SID in the braces
% \student{ name 2 }{sid 2 } 
% v -- ASSIGNMENT NUMBER in the braces
\assignment{ 2 } 
% v-- DUE DATE in the braces
\duedate{February 5 }  

\medskip

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\lineacross

%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem} % problem 1
	\vspace{0.05in}
    \noindent  Prove the following statement: 
    
    
    \noindent 
    If $p > 5$ and $gcd(p, 20) = 1$,
    then $(p^2 -21)(p^2 +16)\equiv 0 \pmod{20}$.
    
    \vspace{0.1in}
    \noindent  
    \emph{Hint:} 
    The product of any $k$ consecutive integers is divisible by $k$.

\end{problem}

%---------------------------

\begin{solution} % solution 1
	SOLUTION 1 GOES HERE
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% problem 2
\pagebreak
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\vspace{0.05in}
\begin{problem}

\vspace{0.05in}
\noindent  Alice's RSA public key is $P = (e,n) = (7, 4453)$.
Bob sends Alice the message by encoding it as follows.
First he assigns numbers to characters:
A is 8, B is 9, ..., Z is 33, a blank is 34, quotation marks: 35, a coma:  36, a period: 37, an apostrophe: 38. Then he uses RSA to encode each number separately. 

\vspace{0.1in}
\noindent Bob's encoded message is:

\begin{verbatim}

 1400 2218   99 2088 4191   84  843   99 4191 3780  764 4191 2979 2269   99  764 
 2218 2269 2088  843 3015   99 2970 1443 1655   99 3237 2979   99  447 1443 3237 
 1032 2382  871  843 1655   99  871 1443   99 4242  843   99 4191 2269   99  843 
 4191 2269 2979   99  871 1443   99 2382 2269  843   99 4191 2269   99 3237 2979 
   99  871  843 3780  843 1032 2088 1443 2962  843 2916   99 3237 2979   99  764 
 2218 2269 2088   99 2088 4191 2269   99  447 1443 3237  843   99  871 1655 2382 
  843   99 4242  843  447 4191 2382 2269  843   99 2218   99  447 4191 2962   99
 2962 1443   99 3780 1443 2962 1294  843 1655   99 2970 2218 1294 2382 1655  843 
   99 1443 2382  871   99 2088 1443  764   99  871 1443   99 2382 2269  843   99 
 3237 2979   99  871  843 3780  843 1032 2088 1443 2962  843 2916 1400

\end{verbatim}

\vspace{-0.1in}
\noindent Decode Bob's message.
Notice that you only know Alice's public key, but don't know the private key. So you
need to "break" RSA to decrypt Bob's message. For the solution, you need to provide the following:
%
\begin{description}

	\item (a) Describe step by step how you 
	arrived at the solution: show how to find $p$ and $q$, $\phi(n)$ and $d$. 
	\item (b) Show your work for one integer in the message (M = 2218):  the expression, the decrypted integer, the character that it is mapped to.  
    \item (c) To decode the remaining numbers, you need to write a program in C++ (see below), test it in Gradescope, and append the code to HW 2, Problem 2 solutions.   
	\item (d) Give the decoded message (in integers).
	\item (e) Give Bob's message in
	plaintext. What does it mean and who said it?

\end{description}

\vspace{0.2in}
\noindent For part (c). Your program should :
\begin{description}

	\item (i) Take three integers, $e$, $n$ (the public key for RSA), and $m$ (the number of characters in the message) as input to your program. Next, input the ciphertext.
	\item (ii) Test whether the public key is valid. If not, output a single line ``Public key is not valid!'' and quit the program.
	\item (iv) If the public key is valid, decode the message.
	\item (v) Output $p$ and $q$, $\phi(n)$ and $d$.
	\item (vi) On a new line, output the decoded message in integers.
	\item (vii) On a new line, output the decoded message in English. The characters should be all uppercase. You can assume that the numbers will be assigned to characters according to the mapping above.
 
\end{description}

\noindent More information and specifications will be provided separately.

\vspace{0.2in}
\noindent Upload your code to Gradescope to test. There will be 15-16 (open and hidden) test cases.  Your score for the RSA code will be based on the score that you received in Gradescope. If you have any questions, post them on Slack.


\end{problem}
\vspace{0.2in}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%-----------------------------
% solution 2
\begin{solution}
	SOLUTION 2 GOES HERE
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%
\pagebreak
\begin{problem} % problem 3
 	

    \medskip\noindent
    (a) Compute $5^{1627}\pmod{12}$. Show your work.
    
    \medskip\noindent
    (b) Compute $8^{-1}\pmod{17}$ by listing the multiples. Show your work.
    
    \medskip\noindent
    (c) Compute $8^{-1}\pmod{17}$ using Fermat's Little Theorem. Show your work.
    
    \medskip\noindent
    (d) Compute $8^{-11}\pmod{17}$ using Fermat's Little Theorem. Show your work.
    
    \medskip\noindent
    (e) Find an integer $x$, $0\le x \le 40$, that satisfies the following congruence:
    $31x + 54 \equiv 16 \pmod{41}$. Show your work. You should not use brute force approach.
    

\end{problem}

%----------------------------
% \pagebreak
\begin{solution} % solution 3

    \medskip\noindent
    (a) $5^{1627}\pmod{12} 
        \\ \equiv 5\cdot (5^2)^{813}\pmod{12} 
        \\ \equiv 5\cdot (25)^{813}\pmod{12} 
        \\ \equiv 5\cdot (1)^{813}\pmod{12} 
        \\ \equiv 5\pmod{12}.$

    \medskip\noindent
    (b) $8^{-1}\pmod{17} \implies 8a \equiv 1\pmod{17} \implies 8a = 17b + 1$.
        We need to find an $a$ to make this equation true.
        \\Multiples of $8$: $8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120$
        \\Multiples of 17 (and then +1): $18, 35, 52, 69, 86, 103, 120$
        \\ We can see that the equation is true when $a=15$ and $b=7$. This means that $8^{-1}\pmod{17} \equiv 15$.  
    
    \medskip\noindent
    (c) According to Fermat's Little Theorem, $a^{p-1} \equiv 1\pmod{p}$, 
        where p is prime. Since $8^{-1}\pmod{17}$, 
        and 17 is prime, then $8x \equiv 1\pmod{17}$, for some a.
        By Fermat's Little Theorem, 
        we can say: $8^{16} \equiv 8^{17-1} \equiv 1\pmod{17}
        \implies 8\cdot 8^{15} \equiv 1\pmod{17}\\ \implies 
        8^{-1} \equiv 8^{15} \pmod{17}
        \\ \equiv 8(8^2)^7 \pmod{17}
        \\ \equiv 8(64)^7 \pmod{17}
        \\ \equiv 8(13)^7 \pmod{17}
        \\ \equiv (8)(13)(13^2)^3  \pmod{17}
        \\ \equiv 104(169)^3 \pmod{17}
        \\ \equiv 2(16)^3 \pmod{17}
        \\ \equiv 2(16)(16)^2 \pmod{17}
        \\ \equiv 32(256) \pmod{17}
        \\ \equiv 15(256) \pmod{17}
        \\ \equiv 15(1) \pmod{17}
        \\ \equiv 15 \pmod{17}
        $. 
        \\ Therefore, $8^{-1}\pmod{17} = 15$.

    \pagebreak
    \medskip\noindent
    (d) $8^{-11}\pmod{17}$ is the same 
        as $(8^{-1})^{11}\pmod{17}$.
        we know that, by the result 
        found in parts b and c,
        that $8^{-1}\pmod{17} = 15$.
        This means that
        $(8^{-1})^{11}
        \equiv 15^{11} \pmod{17}$. 
        From here, since we want to use Fermat's 
        Little Theorem, we should multiply by 
        $(8^5)(8^{-1})^{5} \equiv (8^5)(15)^{5} 
        \equiv 1\pmod{17}$.
        We know this to be true because of the properties
        of inverses. We now have
        $8^5(15^5)(15^{11})
        \\\equiv 8^5(15)^{16}\pmod{17}$. By Fermat's 
        Little Theorem (as stated in part c),
        we can substitute $15^{16}$ with $1$: 
        $8^5(15)^{16}\pmod{17} 
        \equiv 8^5\pmod{17}$. Now, we can simplify
        by squaring:
        \\ $8^5 \equiv 8 \cdot 64^2\pmod{17}
        \\ \equiv 8 \cdot 13^2\pmod{17}
        \\ \equiv 8 \cdot 169\pmod{17}
        \\ \equiv 8 \cdot 16\pmod{17}
        \\ \equiv 128\pmod{17}
        \\ \equiv 9\pmod{17}
        $.

        \medskip\noindent
        (e) $31x+54\equiv16\pmod{41}$. 
        First, we can subtract both sides 
        by 54: $31x\equiv-38\pmod{41}
        \\\equiv3\pmod{41}$. Now, we have to find
        the inverse $31^{-1}\pmod{41}$. We can list
        multiples to find the solution of
        $31a = 41k + 1$: 
        \\ multiples of 31: 31, 62, 93, 124
        \\ multplies of 41(+1): 42, 83, 124
        \\ As we can see, the equation is true 
        when $a=4$ and $k=3$. This means that the
        inverse of 31 is 4. Going back to the 
        original equation, we can multiply
        both sides by $31^{-1}$: 
        \\ $31 \cdot 31^{-1}x 
        \equiv 31^{-1}\cdot 3\pmod{41}
        \implies x \equiv 4 \cdot 3 \pmod{41}
        \equiv 12 \pmod{41}
        $. Therefore, $x=12$.


    
    
    
\end{solution}

\end{document}